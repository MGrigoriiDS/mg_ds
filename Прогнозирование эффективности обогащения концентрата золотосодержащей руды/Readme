## Прогнозирование эффективности обогащения концентрата золотосодержащей руды

### Стек инструментов

Глубокая предобработка данных: соединение нескольких таблиц, заполнение пропусков, поиск выбросов и аномалий;  
Создание метрики SMAPE и применение ее в валидации моделей;  
Визуализация исходных данных, библиотеки matplotlib и seaborn;
Тестирование моделей библиотеки sklearn.

### Вводные данные

Горнодобывающая компания разрабатывает предиктивную модель обогащения руды. Алгоритм рассчитывает выход золота из сырья. 
Модель позволяет принимать на вход только богатое сырье на основании небольших проб.

### Цель проекта

Создать модель, предсказывающую содержание драгоценных металлов и шлака на различных этапах обогащения.

### Содержание  

0.0.1  Необходимо подготовить прототип модели машинного обучения для «Цифры».
0.0.2  Необходимо спрогнозировать две величины:
1  Описание данных
1.1  Технологический процесс
1.2  Параметры этапов
1.3  Наименование признаков
2  1. Подготовка данных
2.0.1  1.1. Откроем файлы и изучим их.
2.0.2  1.2. Проверим, что эффективность обогащения рассчитана правильно. Вычислим её на обучающей выборке для признака rougher.output.recovery. Найдем MAE между расчётами и значением признака. Опишем выводы.
2.0.3  1.3. Проанализируем признаки, недоступные в тестовой выборке. Что это за параметры? К какому типу относятся?
2.0.4  1.4. Проведем предобработку данных
2.1  Выводы по главе 1:
3  2. Анализ данных
3.0.1  2.1. Посмотрим, как меняется концентрация металлов (Au, Ag, Pb) на различных этапах очистки. Опишем выводы.
3.0.2  Выводы по главе 2.1:
3.0.3  2.2. Сравним распределения размеров гранул сырья на обучающей и тестовой выборках. Если распределения сильно отличаются друг от друга, оценка модели будет неправильной.
3.0.4  Вывод по главе 2.2:
4  Модель
4.0.1  3.1. Напишем функцию для вычисления итоговой sMAPE. Давайте посмотрим еще раз на формулы:
4.0.2  3.2. Обучим разные модели и оценим их качество кросс-валидацией. Выберите лучшую модель и проверьте её на тестовой выборке. Опишите выводы. Вам пригодятся формулы метрик качества:
4.0.3  Decision_tree_model
4.0.4  Random_forest_model
4.0.5  Выводы по главе 3
5  ИТОГИ:
    
## ИТОГИ:
Мы проверили, что эффективность обогащения рассчитана правильно. Вычислили её на обучающей выборке для признака rougher.output.recovery. Нашли MAE между расчётами и значением признака. Значение MAE близко к нулю, значит значение rougher.output.recovery рассчитано правильно.
Изначально из тестового набора данных были исключены целевые столбцы, оставлены только признаки. В тестовом наборе отсутствовало 34 столбца. Откорректировали.
Заполнили пропуски средним от указанных соседних значений, для этого воспользововались KNNImputer из sklearn.impute.
Проанализировали графики и сделали вывод, что: среднее значение концентрации серебра(Ag) постепенно уменьшается, среднее значение концентрации свинца(Pb) увеличивается, среднее значение концентрации золота(Au) увеличивается.
Сравнили распределения размеров гранул сырья на обучающей и тестовой выборках. Распределения допустимо отличаются друг от друга. Можно сделать вывод, что размеры гранул сырья близки.
Написали функцию для вычисления итогового sMAPE.
Модель LinearRegression, показала лучший результат по итоговой метрике sMAPE на тестовой выборке. sMAPE = 11.69%.
Модель можно использовать для предсказания коэффициента восстановления золота из золотосодержащей руды.
Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.
